
# automatic_method
An automatic method for the identification of cycles in Covid-19 time series data

# Authors
Miaotian Li, Ciprian Doru Giurcaneanu, Jiamou Liu

## Data
In our experiments, we use the daily counts of COVID-19 cases that are publicly available on the website of WHO: [Data](https://covid19.who.int/data). 

## automatic_method
- [read_countries_WHO](#read_countries_WHO)
- [run_filt_WHO](#run_filt_WHO)
- [run_filt_fullsearch](#run_filt_fullsearch)
- [read_countries_latitude](#read_countries_latitude)
- [run_filt_latitude](#run_filt_latitude)

### read_countries_WHO

Data can be downloaded from: [Data](https://covid19.who.int/WHO-COVID-19-global-data.csv). This file contains the data that I have used in my experiments. It is good to use the same data when you will try to understand the code that I have wrote. Function read_countries_WHO.m reads the data from WHO_data.csv and creates a Mat file for each country in the folder WHO/WHO_Data. I have created these files for all countries (There are 236 countries in my experiments.)

### run_filt_WHO

Once you have these Mat files, you can run the main function run_filt_WHO.m. You need to give as input a flag which indicates how the data are transformed (have a look at the comments in the function to understand how to select this flag)
For example, you can call the function like this:
run_filt(wreg, flag_transf, flag_plot, sp, ftype, fdomain)

%Input:

%wreg:          WHO region for which the data is analysed    

%flag_transf:   flag for data transformation

%               0=no transf. is applied to the data

%               1=transf. from GP Nason, Scientific Reports, 2020

%               2=transf. which is usually applied to daily stock markets indices at closing time

%               3=first order differences (computed in time domain)

%flag_plot:     0=no plots, 1=plots for each country

%sp             'day'=daily data, 'week'=weekly data

%ftype          'stop'=stop band filter, 'high'=high pass filter

%fdomain        'time'=filtering in time domain, 'freq'=filtering in freq. domain

run_filt_WHO(wreg, flag_transf, flag_plot, sp, ftype, fdomain)
Note that the WHO region is now an input parameter (wreg).

run_filt_WHO produces two different files. Both of them have the same name, which is given by fina = strcat('Results_', wreg, '_tr', num2str(flag_transf), '_', sp,
'_', ftype, '_', fdomain); However, one file has the extension .txt and the other file has the extension .mat. The .txt file is very similar to the file produced by the previoud version of the code. The .mat file contains the following variables:

seven: T0./(1:5);
t_before: is a matrix of size n*5, where n represents the number of countries in a particular region that can be detected with at least one periodogram or harmonics before applying the filter. The 5 columns correspond to the detection results from T0 to T0/5, where the numbers represent the periods associated with frequencies detected by BIC or SC. It's worth noting that the n in this context does not represent the number of countries contained within a particular region, as there are some countries that cannot be detected with any periodogram or harmonics；
t_after: Most of the content in this also has the same meaning as "t_before." The difference between them is that "t_after" stores the data conclusions after applying the filter. Only countries that were detected with a fundamental periodogram before applying the filter will apply the filter. 

### run_filt_fullsearch

Once you have these Mat files, you can run the main function run_filt_fullsearch.m. You need to give as input a flag which indicates how the data are transformed (have a look at the comments in the function to understand how to select this flag)

%Input:

%wreg:          WHO region for which the data is analysed    

%flag_transf:   flag for data transformation

%               0=no transf. is applied to the data

%               1=transf. from GP Nason, Scientific Reports, 2020

%               2=transf. which is usually applied to daily stock markets indices at closing time

%               3=first order differences (computed in time domain)

%sp             'day'=daily data, 'week'=weekly data

%ftype          'stop'=stop band filter, 'high'=high pass filter

%fdomain        'time'=filtering in time domain, 'freq'=filtering in freq. domain


The output generated by this function is very similar to that of run_filt_WHO.m. Both are algorithms for detecting the fundamental periodogram and harmonics, with slight differences in their processes. The specific distinctions are explained in the PDF document.

### read_countries_latitude

Function read_countries_latitude.m reads the data from WHO_data.csv and creates a Mat file for each country in the folder Latitude/WHO_Data
It's worth noting that the WHO website does not provide specific information about the latitude position for each country. Therefore, we need to carry out some manual labeling. I have created these files for all countries (There are 236 countries in my experiments.) we extend our analysis by categorizing the CTA’s according to the latitudinal position of the capital city. This relies on the fact that the capital cities are typically in central locations within countries and have the highest economics activities and population densities.


### run_filt_latitude

Once you have these Mat files, you can run the main function run_filt_latitude.m. You need to give as input a flag which indicates how the data are transformed (have a look at the comments in the function to understand how to select this flag)
For example, you can call the function like this:
run_filt(latitude, flag_transf, flag_plot, sp, ftype, fdomain)

%Input:

%latitude:          Latitude group for which the data is analysed  

%flag_transf:   flag for data transformation

%               0=no transf. is applied to the data

%               1=transf. from GP Nason, Scientific Reports, 2020

%               2=transf. which is usually applied to daily stock markets indices at closing time

%               3=first order differences (computed in time domain)

%flag_plot:     0=no plots, 1=plots for each country

%sp             'day'=daily data, 'week'=weekly data

%ftype          'stop'=stop band filter, 'high'=high pass filter

%fdomain        'time'=filtering in time domain, 'freq'=filtering in freq. domain

run_filt_latitude produces two different files. Both of them have the same name, which is given by fina = strcat('Results_', wreg, '_tr', num2str(flag_transf), '_', sp,
'_', ftype, '_', fdomain);
However, one file has the extension .txt and the other file has the extension .mat. The .txt file is very similar to the file produced by the previous version of the code.
The .mat file contains the following variables:

noc = total number of countries in the particular latitude group
seven = seven = T0./(1:5);
BICo has five entries:
first entry: total no. of the countries in the latitude group for which BIC has found the periodicity T0 in the data, before filtering
second entry: total no. of the countries in the latitude group for which BIC has found the periodicity T0/2 in the data, before filtering
fifth entry: total no. of the countries in the latitude group for which BIC has found the periodicity T0/5 in the data, before filtering
BICf   = similar to BICo, except that the statistics are for the filtered data
SCo = similar to BICo, except that SC is used instead of BIC
SCf = similar to BICf, except that SC is used instead of BIC


The full report can be found at [Link]().
